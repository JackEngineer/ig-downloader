# Instagram è§†é¢‘ä¸‹è½½å™¨

ä¸€ä¸ªå¼ºå¤§çš„ Instagram è§†é¢‘è‡ªåŠ¨ä¸‹è½½å·¥å…·ï¼Œæ”¯æŒç”¨æˆ·è·Ÿè¸ªã€å»é‡æ£€æµ‹å’Œå®šæ—¶ä»»åŠ¡è°ƒåº¦ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **å¤šç”¨æˆ·è·Ÿè¸ª** - åŒæ—¶è¿½è¸ªå¤šä¸ª Instagram è´¦å·
- ğŸ”„ **æ™ºèƒ½å»é‡** - è‡ªåŠ¨è¯†åˆ«å·²ä¸‹è½½çš„è§†é¢‘ï¼Œé¿å…é‡å¤ä¸‹è½½
- â° **å®šæ—¶è°ƒåº¦** - æ”¯æŒ cron å®šæ—¶ä»»åŠ¡ï¼Œè‡ªåŠ¨è¿è¡Œä¸‹è½½
- ğŸ“Š **ç»Ÿè®¡åˆ†æ** - æŸ¥çœ‹æ¯ä¸ªç”¨æˆ·çš„ä¸‹è½½å†å²å’Œç»Ÿè®¡ä¿¡æ¯
- ğŸš€ **æ‰¹é‡ä¸‹è½½** - å¹¶å‘ä¸‹è½½å¤šä¸ªè§†é¢‘ï¼Œæå‡æ•ˆç‡
- ğŸ’¾ **æ–­ç‚¹ç»­ä¼ ** - ä¸‹è½½å¤±è´¥è‡ªåŠ¨é‡è¯•ï¼Œå¸¦æŒ‡æ•°é€€é¿ç­–ç•¥
- ğŸ¨ **å‹å¥½ç•Œé¢** - å½©è‰²ç»ˆç«¯è¾“å‡ºï¼Œå®æ—¶è¿›åº¦æç¤º
- ğŸ” **å¹²è¿è¡Œæ¨¡å¼** - é¢„è§ˆä¸‹è½½å†…å®¹è€Œä¸å®é™…ä¸‹è½½

## ğŸ“¦ å®‰è£…

### ç¯å¢ƒè¦æ±‚

- Node.js 16+
- npm

### å®‰è£…æ­¥éª¤

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/JackEngineer/ig-downloader.git
cd ig-downloader

# å®‰è£…ä¾èµ–
npm install

# æ„å»ºé¡¹ç›®
npm run build

# å®‰è£… Playwright æµè§ˆå™¨ï¼ˆé¦–æ¬¡è¿è¡Œéœ€è¦ï¼‰
npx playwright install chromium
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æ·»åŠ è¦è·Ÿè¸ªçš„ç”¨æˆ·

```bash
# æ·»åŠ ç”¨æˆ·
npm start add natgeo --note "å›½å®¶åœ°ç†"

# é™åˆ¶æœ€å¤§è§†é¢‘æ•°
npm start add bbcnews --max-videos 5
```

### 2. æŸ¥çœ‹è·Ÿè¸ªåˆ—è¡¨

```bash
npm start list
```

### 3. ä¸‹è½½è§†é¢‘

```bash
# ä¸‹è½½æ‰€æœ‰ç”¨æˆ·çš„æ–°è§†é¢‘
npm start run

# åªä¸‹è½½ç‰¹å®šç”¨æˆ·
npm start run natgeo

# é¢„è§ˆæ¨¡å¼ï¼ˆä¸å®é™…ä¸‹è½½ï¼‰
npm start run --dry-run
```

### 4. é…ç½®å®šæ—¶ä»»åŠ¡

```bash
# ä½¿ç”¨å‘å¯¼é…ç½®å®šæ—¶è®¡åˆ’
npm start schedule-wizard

# å®‰è£…åˆ°ç³»ç»Ÿ crontab
npm start install-cron

# æŸ¥çœ‹å®šæ—¶ä»»åŠ¡çŠ¶æ€
npm start cron
```

## ğŸ“– å‘½ä»¤è¯¦è§£

### ç”¨æˆ·ç®¡ç†

#### `add <ç”¨æˆ·å>` - æ·»åŠ è·Ÿè¸ªç”¨æˆ·

```bash
npm start add <ç”¨æˆ·å> [é€‰é¡¹]
```

é€‰é¡¹ï¼š

- `--max-videos <æ•°é‡>` - è®¾ç½®è¯¥ç”¨æˆ·æœ€å¤§ä¸‹è½½è§†é¢‘æ•°ï¼ˆé»˜è®¤ 20ï¼‰
- `--note <æ–‡æœ¬>` - ä¸ºç”¨æˆ·æ·»åŠ å¤‡æ³¨æ ‡ç­¾

ç¤ºä¾‹ï¼š

```bash
npm start add natgeo --max-videos 10 --note "å›½å®¶åœ°ç†å®˜æ–¹"
npm start add bbcnews --note "BBCæ–°é—»"
```

#### `remove <ç”¨æˆ·å>` - ç§»é™¤ç”¨æˆ·

```bash
npm start remove natgeo
npm start rm bbcnews  # ç®€å†™å½¢å¼
```

#### `enable <ç”¨æˆ·å>` - å¯ç”¨ç”¨æˆ·

é‡æ–°å¯ç”¨å·²ç¦ç”¨çš„ç”¨æˆ·ï¼š

```bash
npm start enable natgeo
```

#### `disable <ç”¨æˆ·å>` - ç¦ç”¨ç”¨æˆ·

æš‚æ—¶ç¦ç”¨ç”¨æˆ·è€Œä¸åˆ é™¤å…¶å†å²è®°å½•ï¼š

```bash
npm start disable natgeo
```

#### `list` - æŸ¥çœ‹è·Ÿè¸ªåˆ—è¡¨

æ˜¾ç¤ºæ‰€æœ‰è·Ÿè¸ªç”¨æˆ·åŠå…¶ç»Ÿè®¡ä¿¡æ¯ï¼š

```bash
npm start list
npm start ls  # ç®€å†™å½¢å¼
```

è¾“å‡ºåŒ…æ‹¬ï¼š

- ç”¨æˆ·å
- å¯ç”¨çŠ¶æ€
- æœ€å¤§è§†é¢‘æ•°é™åˆ¶
- å·²ä¸‹è½½è§†é¢‘æ•°é‡
- æ€»ä¸‹è½½å¤§å°
- ç”¨æˆ·å¤‡æ³¨

### ä¸‹è½½ç®¡ç†

#### `run [ç”¨æˆ·å]` - æ‰§è¡Œä¸‹è½½

```bash
npm start run [ç”¨æˆ·å] [é€‰é¡¹]
```

é€‰é¡¹ï¼š

- `--dry-run` - é¢„è§ˆæ¨¡å¼ï¼Œåªæ˜¾ç¤ºå°†è¦ä¸‹è½½çš„å†…å®¹

ç¤ºä¾‹ï¼š

```bash
# ä¸‹è½½æ‰€æœ‰å¯ç”¨ç”¨æˆ·çš„æ–°è§†é¢‘
npm start run

# åªä¸‹è½½ç‰¹å®šç”¨æˆ·
npm start run natgeo

# é¢„è§ˆå°†è¦ä¸‹è½½çš„å†…å®¹
npm start run --dry-run
```

å·¥ä½œæµç¨‹ï¼š

1. è®¿é—®ç”¨æˆ·çš„ Instagram ä¸»é¡µ
2. æ”¶é›† Reels è§†é¢‘é“¾æ¥
3. æ£€æŸ¥å†å²è®°å½•ï¼Œè¿‡æ»¤å·²ä¸‹è½½çš„è§†é¢‘
4. æå–è§†é¢‘ CDN é“¾æ¥
5. æ‰¹é‡ä¸‹è½½æ–°è§†é¢‘
6. ä¿å­˜ä¸‹è½½è®°å½•åˆ°å†å²æ•°æ®åº“

### é…ç½®ç®¡ç†

#### `config` - æŸ¥çœ‹/ä¿®æ”¹é…ç½®

æŸ¥çœ‹å½“å‰é…ç½®ï¼š

```bash
npm start config
```

ä¿®æ”¹é…ç½®é¡¹ï¼š

```bash
npm start config <é…ç½®é¡¹> <å€¼>
```

å¯ç”¨é…ç½®é¡¹ï¼š

- `download-dir` - è®¾ç½®ä¸‹è½½ç›®å½•
- `max-videos` - è®¾ç½®é»˜è®¤æœ€å¤§è§†é¢‘æ•°
- `scroll-timeout` - è®¾ç½®æ»šåŠ¨è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
- `schedule` - è®¾ç½® cron å®šæ—¶è¡¨è¾¾å¼

ç¤ºä¾‹ï¼š

```bash
# è®¾ç½®ä¸‹è½½ç›®å½•
npm start config download-dir ~/Videos/Instagram

# è®¾ç½®é»˜è®¤æœ€å¤§è§†é¢‘æ•°
npm start config max-videos 20

# è®¾ç½®æ»šåŠ¨è¶…æ—¶
npm start config scroll-timeout 30000

# è®¾ç½®å®šæ—¶è®¡åˆ’ï¼ˆæ¯å¤©æ—©8ç‚¹å’Œæ™š8ç‚¹ï¼‰
npm start config schedule "0 8,20 * * *"
```

### å®šæ—¶ä»»åŠ¡

#### `schedule-wizard` - å®šæ—¶è®¡åˆ’å‘å¯¼

äº¤äº’å¼é…ç½®å®šæ—¶ä»»åŠ¡ï¼ˆæ¨èï¼‰ï¼š

```bash
npm start schedule-wizard
```

æ”¯æŒçš„å®šæ—¶æ¨¡å¼ï¼š

- æ¯å°æ—¶
- æ¯å¤©ï¼ˆæŒ‡å®šæ—¶é—´ï¼‰
- æ¯å‘¨ï¼ˆæŒ‡å®šæ˜ŸæœŸå’Œæ—¶é—´ï¼‰
- æ¯æœˆï¼ˆæŒ‡å®šæ—¥æœŸå’Œæ—¶é—´ï¼‰
- è‡ªå®šä¹‰ cron è¡¨è¾¾å¼

#### `install-cron` - å®‰è£…å®šæ—¶ä»»åŠ¡

è‡ªåŠ¨å°†ä»»åŠ¡æ·»åŠ åˆ°ç³»ç»Ÿ crontabï¼š

```bash
npm start install-cron
```

åŠŸèƒ½ï¼š

- è‡ªåŠ¨æ£€æµ‹ Node.js è·¯å¾„
- éªŒè¯å¯ç”¨ç”¨æˆ·åˆ—è¡¨
- æ·»åŠ ä»»åŠ¡åˆ° crontab
- é…ç½®æ—¥å¿—è¾“å‡ºåˆ° `~/ig-downloader.log`

#### `uninstall-cron` - å¸è½½å®šæ—¶ä»»åŠ¡

ä» crontab ä¸­ç§»é™¤å®šæ—¶ä»»åŠ¡ï¼š

```bash
npm start uninstall-cron
```

#### `cron` - æŸ¥çœ‹å®šæ—¶ä»»åŠ¡çŠ¶æ€

æ˜¾ç¤ºå½“å‰å®šæ—¶ä»»åŠ¡é…ç½®å’ŒçŠ¶æ€ï¼š

```bash
npm start cron
```

è¾“å‡ºåŒ…æ‹¬ï¼š

- å½“å‰å®šæ—¶è®¡åˆ’
- ä»»åŠ¡æ˜¯å¦å·²å®‰è£…
- crontab ä¸­çš„ä»»åŠ¡æ¡ç›®
- æ‰‹åŠ¨å®‰è£…æŒ‡å—

### ç»Ÿè®¡ä¿¡æ¯

#### `stats` - å…¨å±€ç»Ÿè®¡

æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„ä¸‹è½½ç»Ÿè®¡ï¼š

```bash
npm start stats
```

æ˜¾ç¤ºï¼š

- è·Ÿè¸ªç”¨æˆ·æ€»æ•°
- å·²ä¸‹è½½è§†é¢‘æ€»æ•°
- æ€»ä¸‹è½½å¤§å°

## âš™ï¸ é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨ `~/.ig-downloader/config.json`ï¼š

```json
{
  "downloadDir": "./downloads",
  "maxVideosPerUser": 20,
  "scrollTimeout": 30000,
  "schedule": "0 */6 * * *",
  "users": [
    {
      "username": "natgeo",
      "enabled": true,
      "maxVideos": 10,
      "note": "å›½å®¶åœ°ç†"
    }
  ]
}
```

å†å²è®°å½•å­˜å‚¨åœ¨ `~/.ig-downloader/history.json`ã€‚

## ğŸ“ ç›®å½•ç»“æ„

ä¸‹è½½çš„è§†é¢‘æŒ‰ç”¨æˆ·åç»„ç»‡ï¼š

```
downloads/
â”œâ”€â”€ natgeo/
â”‚   â”œâ”€â”€ natgeo_ABC123_2024-01-15.mp4
â”‚   â””â”€â”€ natgeo_DEF456_2024-01-16.mp4
â””â”€â”€ bbcnews/
    â””â”€â”€ bbcnews_GHI789_2024-01-15.mp4
```

æ–‡ä»¶å‘½åæ ¼å¼ï¼š`{ç”¨æˆ·å}_{shortCode}_{æ—¥æœŸ}.mp4`

## ğŸ”§ å¼€å‘

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ cli.ts              # CLI å…¥å£å’Œå‘½ä»¤å¤„ç†
â”œâ”€â”€ config.ts           # é…ç½®ç®¡ç†
â”œâ”€â”€ config.test.ts      # é…ç½®æ¨¡å—æµ‹è¯•
â”œâ”€â”€ extractor.ts        # åŸºäº Playwright çš„è§†é¢‘æå–
â”œâ”€â”€ downloader.ts       # æ–‡ä»¶ä¸‹è½½é€»è¾‘
â”œâ”€â”€ downloader.test.ts  # ä¸‹è½½å™¨æ¨¡å—æµ‹è¯•
â”œâ”€â”€ history.ts          # ä¸‹è½½å†å²è·Ÿè¸ª
â”œâ”€â”€ logger.ts           # å½©è‰²æ—¥å¿—å·¥å…·
â”œâ”€â”€ logger.test.ts      # æ—¥å¿—æ¨¡å—æµ‹è¯•
â”œâ”€â”€ cron-wizard.ts      # å®šæ—¶ä»»åŠ¡å‘å¯¼
â””â”€â”€ cron-installer.ts   # Crontab å®‰è£…å·¥å…·
```

### å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡æ–°ç¼–è¯‘ï¼‰
npm run dev

# è¿è¡Œæµ‹è¯•
npm run test

# ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test:watch

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# ä»£ç æ£€æŸ¥
npm run lint

# è‡ªåŠ¨ä¿®å¤ lint é—®é¢˜
npm run lint:fix

# æ ¼å¼åŒ–ä»£ç 
npm run format

# æ£€æŸ¥æ ¼å¼
npm run format:check
```

### æŠ€æœ¯æ ˆ

- **TypeScript** - ç±»å‹å®‰å…¨çš„ JavaScript
- **Playwright** - æµè§ˆå™¨è‡ªåŠ¨åŒ–å’Œç½‘ç»œæ‹¦æˆª
- **Vitest** - å¿«é€Ÿçš„å•å…ƒæµ‹è¯•æ¡†æ¶
- **ESLint + Prettier** - ä»£ç è´¨é‡å’Œæ ¼å¼åŒ–å·¥å…·

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- ES2022 + ES æ¨¡å—
- åŒå¼•å·å­—ç¬¦ä¸²
- 2 ç©ºæ ¼ç¼©è¿›
- æ˜¾å¼è¿”å›ç±»å‹
- å‘½åå¯¼å‡ºï¼ˆæ— é»˜è®¤å¯¼å‡ºï¼‰

è¯¦è§ `AGENTS.md` è·å–å®Œæ•´ä»£ç é£æ ¼æŒ‡å—ã€‚

## ğŸ› æ•…éšœæ’é™¤

### æµè§ˆå™¨æœªå®‰è£…

å¦‚æœé‡åˆ° "Executable doesn't exist" é”™è¯¯ï¼š

```bash
npx playwright install chromium
```

### æ— æ³•æå–è§†é¢‘

å¯èƒ½åŸå› ï¼š

- Instagram éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®è¯¥ç”¨æˆ·
- ç”¨æˆ·æ²¡æœ‰å…¬å¼€çš„ Reels
- ç½‘ç»œé—®é¢˜æˆ– Instagram ä¸´æ—¶é™æµ

è§£å†³æ–¹æ¡ˆï¼š

- å°è¯•ä½¿ç”¨ `--dry-run` æ£€æŸ¥é“¾æ¥æ”¶é›†æ˜¯å¦æ­£å¸¸
- æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä¸ºå…¬å¼€è´¦å·
- ç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•

### å®šæ—¶ä»»åŠ¡æœªè¿è¡Œ

æ£€æŸ¥æ­¥éª¤ï¼š

```bash
# æŸ¥çœ‹ crontab é…ç½®
crontab -l

# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f ~/ig-downloader.log

# ç¡®è®¤ä»»åŠ¡çŠ¶æ€
npm start cron
```

### æƒé™é—®é¢˜

ç¡®ä¿ä¸‹è½½ç›®å½•æœ‰å†™å…¥æƒé™ï¼š

```bash
chmod 755 ~/Downloads/Instagram
```

## ğŸ“ æ³¨æ„äº‹é¡¹

âš ï¸ **ä½¿ç”¨é¡»çŸ¥**ï¼š

1. æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ å’Œä¸ªäººä½¿ç”¨
2. è¯·éµå®ˆ Instagram çš„ä½¿ç”¨æ¡æ¬¾
3. é¿å…è¿‡äºé¢‘ç¹çš„è¯·æ±‚ï¼Œä»¥å…è§¦å‘é™æµ
4. ä¸è¦ç”¨äºå•†ä¸šç”¨é€”æˆ–ä¾µçŠ¯ç‰ˆæƒ
5. ä¸‹è½½çš„å†…å®¹ç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ”— ç›¸å…³èµ„æº

- [Playwright æ–‡æ¡£](https://playwright.dev)
- [Cron è¡¨è¾¾å¼æŒ‡å—](https://crontab.guru)
- [TypeScript æ–‡æ¡£](https://www.typescriptlang.org)

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åé¦ˆï¼
